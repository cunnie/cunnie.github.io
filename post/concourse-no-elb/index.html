<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Concourse without a Load Balancer | Brian Cunnie's Technical Blog</title><meta name=keywords content><meta name=description content="Abstract
Concourse is a continuous integration (CI) server. It
can be deployed manually or via
BOSH.
In this blog post, we describe the BOSH deployment of a Concourse CI server to
natively accept Secure Sockets Layer (SSL) connections without using a load
balancer. This may reduce the complexity and cost
[ELB-pricing] of a Concourse deployment.
 2016-09-12: This blog post is
obsolete. Newer (v2.0.0+) versions of Concourse allow binding to the privileged
ports 80 and 443, eliminating the need for an nginx proxy. Here is an example
of a BOSH-deployed Concourse server that binds natively to ports 80 & 443: BOSH
manifest.  
0. Pre-requisites
Deploy Concourse with BOSH. Follow the instructions
here."><meta name=author content="Brian Cunnie"><link rel=canonical href=https://blog.nono.io/post/concourse-no-elb/><link crossorigin=anonymous href=/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.nono.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.nono.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.nono.io/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.nono.io/apple-touch-icon.png><link rel=mask-icon href=https://blog.nono.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.nono.io/post/concourse-no-elb/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-0NJ11E527T"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-0NJ11E527T")}</script><meta property="og:url" content="https://blog.nono.io/post/concourse-no-elb/"><meta property="og:site_name" content="Brian Cunnie's Technical Blog"><meta property="og:title" content="Concourse without a Load Balancer"><meta property="og:description" content="Abstract Concourse is a continuous integration (CI) server. It can be deployed manually or via BOSH.
In this blog post, we describe the BOSH deployment of a Concourse CI server to natively accept Secure Sockets Layer (SSL) connections without using a load balancer. This may reduce the complexity and cost [ELB-pricing] of a Concourse deployment.
2016-09-12: This blog post is obsolete. Newer (v2.0.0+) versions of Concourse allow binding to the privileged ports 80 and 443, eliminating the need for an nginx proxy. Here is an example of a BOSH-deployed Concourse server that binds natively to ports 80 & 443: BOSH manifest. 0. Pre-requisites Deploy Concourse with BOSH. Follow the instructions here."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2016-08-26T06:58:07-07:00"><meta property="article:modified_time" content="2016-08-26T06:58:07-07:00"><meta property="og:image" content="https://nono.io/images/brian_cunnie_profile.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://nono.io/images/brian_cunnie_profile.jpg"><meta name=twitter:title content="Concourse without a Load Balancer"><meta name=twitter:description content="Abstract
Concourse is a continuous integration (CI) server. It
can be deployed manually or via
BOSH.
In this blog post, we describe the BOSH deployment of a Concourse CI server to
natively accept Secure Sockets Layer (SSL) connections without using a load
balancer. This may reduce the complexity and cost
[ELB-pricing] of a Concourse deployment.
 2016-09-12: This blog post is
obsolete. Newer (v2.0.0+) versions of Concourse allow binding to the privileged
ports 80 and 443, eliminating the need for an nginx proxy. Here is an example
of a BOSH-deployed Concourse server that binds natively to ports 80 & 443: BOSH
manifest.  
0. Pre-requisites
Deploy Concourse with BOSH. Follow the instructions
here."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.nono.io/post/"},{"@type":"ListItem","position":2,"name":"Concourse without a Load Balancer","item":"https://blog.nono.io/post/concourse-no-elb/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Concourse without a Load Balancer","name":"Concourse without a Load Balancer","description":"Abstract Concourse is a continuous integration (CI) server. It can be deployed manually or via BOSH.\nIn this blog post, we describe the BOSH deployment of a Concourse CI server to natively accept Secure Sockets Layer (SSL) connections without using a load balancer. This may reduce the complexity and cost [ELB-pricing] of a Concourse deployment.\n2016-09-12: This blog post is obsolete. Newer (v2.0.0+) versions of Concourse allow binding to the privileged ports 80 and 443, eliminating the need for an nginx proxy. Here is an example of a BOSH-deployed Concourse server that binds natively to ports 80 \u0026 443: BOSH manifest. 0. Pre-requisites Deploy Concourse with BOSH. Follow the instructions here.\n","keywords":[],"articleBody":"Abstract Concourse is a continuous integration (CI) server. It can be deployed manually or via BOSH.\nIn this blog post, we describe the BOSH deployment of a Concourse CI server to natively accept Secure Sockets Layer (SSL) connections without using a load balancer. This may reduce the complexity and cost [ELB-pricing] of a Concourse deployment.\n2016-09-12: This blog post is obsolete. Newer (v2.0.0+) versions of Concourse allow binding to the privileged ports 80 and 443, eliminating the need for an nginx proxy. Here is an example of a BOSH-deployed Concourse server that binds natively to ports 80 \u0026 443: BOSH manifest. 0. Pre-requisites Deploy Concourse with BOSH. Follow the instructions here.\n1. Upload nginx BOSH Release Next, upload the nginx BOSH release to your director (note that we’re using an experimental CLI whose syntax is slightly different [Golang CLI] ):\nbosh upload-release https://github.com/cloudfoundry-community/nginx-release/releases/download/v4/nginx-4.tgz 2. Add nginx to your BOSH manifest Add the release:\nreleases: - name: nginx version: latest Add the nginx job properties.\nThe following example shows the manifest properties for https://ci.nono.io. Be sure to replace all occurrences of “ci.nono.io” with the fully qualified domain name (FQDN) of your Concourse server. Also, substitute the appropriate SSL certificate(s) and key.\n- name: nginx release: nginx properties: nginx_conf: | worker_processes 1; error_log /var/vcap/sys/log/nginx/error.log info; events { worker_connections 1024; } http { include /var/vcap/packages/nginx/conf/mime.types; default_type application/octet-stream; sendfile on; keepalive_timeout 65; server_names_hash_bucket_size 64; # redirect HTTP to HTTPS server { server_name _; # invalid value which will never trigger on a real hostname. listen 80; rewrite ^ https://ci.nono.io$request_uri?; access_log /var/vcap/sys/log/nginx/ci.nono.io-access.log; error_log /var/vcap/sys/log/nginx/ci.nono.io-error.log; } server { server_name ci.nono.io; # weak DH https://weakdh.org/sysadmin.html ssl_ciphers 'ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA'; ssl_prefer_server_ciphers on; # poodle https://scotthelme.co.uk/sslv3-goes-to-the-dogs-poodle-kills-off-protocol/ ssl_protocols TLSv1 TLSv1.1 TLSv1.2; listen 443 ssl; ssl_certificate /var/vcap/jobs/nginx/etc/ssl_chained.crt.pem; ssl_certificate_key /var/vcap/jobs/nginx/etc/ssl.key.pem; access_log /var/vcap/sys/log/nginx/ci.nono.io-access.log; error_log /var/vcap/sys/log/nginx/ci.nono.io-error.log; root /var/vcap/jobs/nginx/www/document_root; index index.shtml index.html index.htm; # https://www.digitalocean.com/community/tutorials/how-to-configure-nginx-with-ssl-as-a-reverse-proxy-for-jenkins location / { proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; # Fix `websocket: bad handshake` when using `fly intercept` proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection \"upgrade\"; # Fix the “It appears that your reverse proxy set up is broken\" error. proxy_pass http://localhost:8080; proxy_read_timeout 90; proxy_redirect http://localhost:8080 https://ci.nono.io; } } } # FIXME: replace with your HTTPS SSL key ssl_key: ((nono_io_key)) # FIXME: replace with your HTTPS SSL chained certificate ssl_chained_cert: | -----BEGIN CERTIFICATE----- MIIFXDCCBESgAwIBAgIQOvRHkhKyb/k9O4xvIi9zZTANBgkqhkiG9w0BAQsFADCB ... NaaNSyS8pHUJhaq+ZiC7zM2YsuLBICPQfsunHGrho4k= -----END CERTIFICATE----- -----BEGIN CERTIFICATE----- MIIGCDCCA/CgAwIBAgIQKy5u6tl1NmwUim7bo3yMBzANBgkqhkiG9w0BAQwFADCB ... +AZxAeKCINT+b72x -----END CERTIFICATE----- -----BEGIN CERTIFICATE----- MIIFdDCCBFygAwIBAgIQJ2buVutJ846r13Ci/ITeIjANBgkqhkiG9w0BAQwFADBv ... pu/xO28QOG8= -----END CERTIFICATE----- 3. BOSH Deploy We deploy (note that we are using an experimental BOSH CLI whose syntax differs slightly from the canonical Ruby CLI’s):\nbosh deploy -d concourse concourse.yml -l \u003c(lpass show --note deployments) We browse to our newly-deployed Concourse server to verify an SSL connection: https://ci.nono.io\n4. Manifests Concourse server + nginx front-end BOSH manifest BOSH Director Cloud Config manifest BOSH Director manifest [Google Cloud] Addendum: Using Concourse’s Built-in TLS instead of nginx Concourse has BOSH job properties that allow you to set the TLS key and certificate, bypassing the need for a colocated nginx job:\ninstance_groups: jobs: atc: properties: tls_cert: | -----BEGIN CERTIFICATE----- MIIFXDCCBESgAwIBAgIQOvRHkhKyb/k9O4xvIi9zZTANBgkqhkiG9w0BAQsFADCB ... NaaNSyS8pHUJhaq+ZiC7zM2YsuLBICPQfsunHGrho4k= -----END CERTIFICATE----- -----BEGIN CERTIFICATE----- MIIGCDCCA/CgAwIBAgIQKy5u6tl1NmwUim7bo3yMBzANBgkqhkiG9w0BAQwFADCB .... pu/xO28QOG8= -----END CERTIFICATE----- tls_key: | -----BEGIN RSA PRIVATE KEY----- This simple solution has a downside: the Concourse URI’s requires a port number at the end (e.g. the URI would be https://ci.nono.io:4443 instead of https://ci.nono.io). [privileged]\nHere is a sample BOSH manifest which uses Concourse’s built-in TLS.\nFootnotes [ELB-pricing] ELB pricing, as of this writing, is $0.025/hour, $0.60/day, $219.15 / year (assuming 365.24 days / year).\nLoad balancers (specifically ELBs) offer the ability to direct traffic to a pool of backend servers and to automatically remove a server from the pool if it becomes unresponsive; however, this feature is often unneeded — we are unaware of any Concourse server deployments which have multiple backends. A load balancer in front of a Concourse server is an unnecessary expense in our opinion.\n[Golang CLI] We are using an experimental Golang-based BOSH command line interface (CLI), and the arguments are slightly different than those of canonical Ruby-based BOSH CLI; however, the arguments are similar enough to be readily adapted to the Ruby CLI (e.g. the Golang CLI’s bosh upload-stemcell equivalent to the Ruby CLI’s bosh upload stemcell (no dash)).\nThe new CLI also allows variable interpolation, with the value of the variables to interpolate passed in via YAML file on the command line. This feature allows the redaction of sensitive values (e.g. SSL keys) from the manifest. The format is similar to Concourse’s interpolation, except that interpolated values are bracketed by double parentheses “((key))”, whereas Concourse uses double curly braces “{{key}}”.\nSimilar to Concourse, the experimental BOSH CLI allows the YAML file containing the secrets to be passed via the command line, e.g. -l ~/secrets.yml or -l \u003c(lpass show --note secrets)\nThe Golang CLI is in alpha and should not be used on production systems.\n[Google Cloud] We are deploying to Google Cloud Platform’s Google Compute Engine (GCE), and thus the cloud_properties sections of the BOSH Director’s manifest may appear unfamiliar to those who deploy on AWS or vSphere.\n[privileged] Concourse will not bind to a privileged port.\nYou may attempt to force atc to bind to port 443 by setting its tls_bind_port job property, but it will not work, atc will not start, and you will see the following message in /var/vcap/sys/log/atc/atc.stderr.log:\nweb-tls exited with error: listen tcp 0.0.0.0:443: bind: permission denied ","wordCount":"886","inLanguage":"en","image":"https://nono.io/images/brian_cunnie_profile.jpg","datePublished":"2016-08-26T06:58:07-07:00","dateModified":"2016-08-26T06:58:07-07:00","author":{"@type":"Person","name":"Brian Cunnie"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.nono.io/post/concourse-no-elb/"},"publisher":{"@type":"Organization","name":"Brian Cunnie's Technical Blog","logo":{"@type":"ImageObject","url":"https://blog.nono.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.nono.io/ accesskey=h title="Brian Cunnie's Technical Blog (Alt + H)">Brian Cunnie's Technical Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.nono.io/>Home</a>&nbsp;»&nbsp;<a href=https://blog.nono.io/post/>Posts</a></div><h1 class="post-title entry-hint-parent">Concourse without a Load Balancer</h1><div class=post-meta><span title='2016-08-26 06:58:07 -0700 -0700'>August 26, 2016</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Brian Cunnie&nbsp;|&nbsp;<a href=https://github.com/cunnie/cunnie.github.io/tree/master/content/post/concourse-no-elb.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><h2 id=abstract>Abstract<a hidden class=anchor aria-hidden=true href=#abstract>#</a></h2><p><a href=http://concourse.ci/>Concourse</a> is a continuous integration (CI) server. It
can be deployed manually or via
<a href=http://concourse.ci/clusters-with-bosh.html>BOSH</a>.</p><p>In this blog post, we describe the BOSH deployment of a Concourse CI server to
natively accept Secure Sockets Layer (SSL) connections without using a load
balancer. This may reduce the complexity and cost
<sup><a href=/post/concourse-no-elb/#ELB-pricing>[ELB-pricing]</a></sup> of a Concourse deployment.</p><div class="alert alert-danger" role=alert>2016-09-12: This blog post is
obsolete. Newer (v2.0.0+) versions of Concourse allow binding to the privileged
ports 80 and 443, eliminating the need for an nginx proxy. Here is an example
of a BOSH-deployed Concourse server that binds natively to ports 80 & 443: <a href=https://github.com/cunnie/deployments/blob/62d0ed813879440f656b6e0bd6f984d708c4bff2/concourse-ntp-pdns-gce.yml#L48-L51>BOSH
manifest</a>.</div><h3 id=0-pre-requisites>0. Pre-requisites<a hidden class=anchor aria-hidden=true href=#0-pre-requisites>#</a></h3><p>Deploy Concourse with BOSH. Follow the instructions
<a href=http://concourse.ci/clusters-with-bosh.html>here</a>.</p><h3 id=1-upload-nginx-bosh-release>1. Upload nginx BOSH Release<a hidden class=anchor aria-hidden=true href=#1-upload-nginx-bosh-release>#</a></h3><p>Next, upload the nginx BOSH release to your director (note that we&rsquo;re using an
experimental CLI whose syntax is slightly different <sup><a href=/post/concourse-no-elb/#golangcli>[Golang
CLI]</a></sup> ):</p><pre tabindex=0><code>bosh upload-release https://github.com/cloudfoundry-community/nginx-release/releases/download/v4/nginx-4.tgz
</code></pre><h3 id=2-add-nginx-to-your-bosh-manifest>2. Add nginx to your BOSH manifest<a hidden class=anchor aria-hidden=true href=#2-add-nginx-to-your-bosh-manifest>#</a></h3><p>Add the release:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>releases</span>:
</span></span><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>nginx</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>version</span>: <span style=color:#ae81ff>latest</span>
</span></span></code></pre></div><p>Add the nginx job properties.</p><p>The following example shows the manifest properties for
<a href=https://ci.nono.io>https://ci.nono.io</a>. Be sure to replace all occurrences of
&ldquo;ci.nono.io&rdquo; with the fully qualified domain name (FQDN) of your Concourse
server. Also, substitute the appropriate SSL certificate(s) and key.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>nginx</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>release</span>: <span style=color:#ae81ff>nginx</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>properties</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>nginx_conf</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      worker_processes  1;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      error_log /var/vcap/sys/log/nginx/error.log   info;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      events {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        worker_connections  1024;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      http {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        include /var/vcap/packages/nginx/conf/mime.types;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        default_type  application/octet-stream;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        sendfile        on;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        keepalive_timeout  65;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        server_names_hash_bucket_size 64;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        # redirect HTTP to HTTPS
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        server {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          server_name _; # invalid value which will never trigger on a real hostname.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          listen 80;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          rewrite ^ https://ci.nono.io$request_uri?;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          access_log /var/vcap/sys/log/nginx/ci.nono.io-access.log;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          error_log /var/vcap/sys/log/nginx/ci.nono.io-error.log;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        server {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          server_name ci.nono.io;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          # weak DH https://weakdh.org/sysadmin.html
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          ssl_ciphers &#39;ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA&#39;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          ssl_prefer_server_ciphers on;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          # poodle https://scotthelme.co.uk/sslv3-goes-to-the-dogs-poodle-kills-off-protocol/
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          listen              443 ssl;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          ssl_certificate     /var/vcap/jobs/nginx/etc/ssl_chained.crt.pem;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          ssl_certificate_key /var/vcap/jobs/nginx/etc/ssl.key.pem;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          access_log /var/vcap/sys/log/nginx/ci.nono.io-access.log;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          error_log /var/vcap/sys/log/nginx/ci.nono.io-error.log;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          root /var/vcap/jobs/nginx/www/document_root;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          index index.shtml index.html index.htm;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          # https://www.digitalocean.com/community/tutorials/how-to-configure-nginx-with-ssl-as-a-reverse-proxy-for-jenkins
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          location / {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              proxy_set_header  Host $host;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              proxy_set_header  X-Real-IP $remote_addr;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              proxy_set_header  X-Forwarded-Proto $scheme;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              # Fix `websocket: bad handshake` when using `fly intercept`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              proxy_set_header  Upgrade $http_upgrade;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              proxy_set_header  Connection &#34;upgrade&#34;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              # Fix the “It appears that your reverse proxy set up is broken&#34; error.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              proxy_pass          http://localhost:8080;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              proxy_read_timeout  90;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              proxy_redirect      http://localhost:8080 https://ci.nono.io;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      }</span>      
</span></span><span style=display:flex><span>    <span style=color:#75715e># FIXME: replace with your HTTPS SSL key</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ssl_key</span>: <span style=color:#ae81ff>((nono_io_key))</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># FIXME: replace with your HTTPS SSL chained certificate</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ssl_chained_cert</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      -----BEGIN CERTIFICATE-----
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      MIIFXDCCBESgAwIBAgIQOvRHkhKyb/k9O4xvIi9zZTANBgkqhkiG9w0BAQsFADCB
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      ...
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      NaaNSyS8pHUJhaq+ZiC7zM2YsuLBICPQfsunHGrho4k=
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      -----END CERTIFICATE-----
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      -----BEGIN CERTIFICATE-----
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      MIIGCDCCA/CgAwIBAgIQKy5u6tl1NmwUim7bo3yMBzANBgkqhkiG9w0BAQwFADCB
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      ...
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      +AZxAeKCINT+b72x
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      -----END CERTIFICATE-----
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      -----BEGIN CERTIFICATE-----
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      MIIFdDCCBFygAwIBAgIQJ2buVutJ846r13Ci/ITeIjANBgkqhkiG9w0BAQwFADBv
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      ...
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      pu/xO28QOG8=
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      -----END CERTIFICATE-----</span>      
</span></span></code></pre></div><h3 id=3-bosh-deploy>3. BOSH Deploy<a hidden class=anchor aria-hidden=true href=#3-bosh-deploy>#</a></h3><p>We deploy (note that we are using an experimental BOSH CLI whose syntax
differs slightly from the canonical Ruby CLI&rsquo;s):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>bosh deploy -d concourse concourse.yml -l &lt;<span style=color:#f92672>(</span>lpass show --note deployments<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>We browse to our newly-deployed Concourse server to verify an SSL connection:
<a href=https://ci.nono.io>https://ci.nono.io</a></p><figure><img loading=lazy src=https://cloud.githubusercontent.com/assets/1020675/18006701/ac76b628-6b55-11e6-9ac2-afc69dc96b51.png></figure><h3 id=4-manifests>4. Manifests<a hidden class=anchor aria-hidden=true href=#4-manifests>#</a></h3><ul><li>Concourse server + nginx front-end <a href=https://github.com/cunnie/deployments/blob/84900b6067b8d935e86991f428c4f246914082b7/concourse.yml>BOSH
manifest</a></li><li>BOSH Director Cloud Config
<a href=https://github.com/cunnie/deployments/blob/84900b6067b8d935e86991f428c4f246914082b7/cloud-config-gce.yml>manifest</a></li><li>BOSH Director
<a href=https://github.com/cunnie/deployments/blob/84900b6067b8d935e86991f428c4f246914082b7/bosh-gce.yml>manifest</a>
<sup><a href=/post/concourse-no-elb/#google_cloud>[Google Cloud]</a></sup></li></ul><h3 id=addendum-using-concourses-built-in-tls-instead-of-nginx>Addendum: Using Concourse&rsquo;s Built-in TLS instead of nginx<a hidden class=anchor aria-hidden=true href=#addendum-using-concourses-built-in-tls-instead-of-nginx>#</a></h3><p>Concourse has BOSH job properties that allow you to set the TLS key and
certificate, bypassing the need for a colocated nginx job:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>instance_groups</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>atc</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>properties</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>tls_cert</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          -----BEGIN CERTIFICATE-----
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          MIIFXDCCBESgAwIBAgIQOvRHkhKyb/k9O4xvIi9zZTANBgkqhkiG9w0BAQsFADCB
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          ...
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          NaaNSyS8pHUJhaq+ZiC7zM2YsuLBICPQfsunHGrho4k=
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          -----END CERTIFICATE-----
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          -----BEGIN CERTIFICATE-----
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          MIIGCDCCA/CgAwIBAgIQKy5u6tl1NmwUim7bo3yMBzANBgkqhkiG9w0BAQwFADCB
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          ....
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          pu/xO28QOG8=
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          -----END CERTIFICATE-----</span>          
</span></span><span style=display:flex><span>        <span style=color:#f92672>tls_key</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          -----BEGIN RSA PRIVATE KEY-----</span>          
</span></span></code></pre></div><p>This simple solution has a downside: the Concourse URI&rsquo;s requires a port number
at the end (e.g. the URI would be <a href=https://ci.nono.io:4443>https://ci.nono.io:4443</a> instead of
<a href=https://ci.nono.io>https://ci.nono.io</a>). <sup><a href=/post/concourse-no-elb/#privileged>[privileged]</a></sup></p><p><a href=https://github.com/cunnie/deployments/blob/1e9a96203acfd806822834f4d6932225771c834b/concourse.yml>Here</a>
is a sample BOSH manifest which uses Concourse&rsquo;s built-in TLS.</p><h2 id=footnotes>Footnotes<a hidden class=anchor aria-hidden=true href=#footnotes>#</a></h2><p><a name=ELB-pricing><sup>[ELB-pricing]</sup></a> ELB pricing, as of this
writing, is
<a href=https://aws.amazon.com/elasticloadbalancing/pricing/>$0.025/hour</a>, $0.60/day,
<strong>$219.15</strong> / year (assuming 365.24 days / year).</p><p>Load balancers (specifically ELBs) offer the ability to direct traffic to a pool
of backend servers and to automatically remove a server from the pool if it
becomes unresponsive; however, this feature is often unneeded — we are
unaware of any Concourse server deployments which have multiple backends. A load
balancer in front of a Concourse server is an unnecessary expense in our opinion.</p><p><a name=golangcli><sup>[Golang CLI]</sup></a>
We are using an experimental Golang-based BOSH command line interface (CLI), and
the arguments are slightly different than those of canonical Ruby-based <a href=https://github.com/cloudfoundry/bosh/tree/master/bosh_cli>BOSH
CLI</a>; however, the
arguments are similar enough to be readily adapted to the Ruby CLI (e.g. the
Golang CLI&rsquo;s <code>bosh upload-stemcell</code> equivalent to the Ruby CLI&rsquo;s <code>bosh upload stemcell</code> (no dash)).</p><p>The new CLI also allows variable interpolation, with the value of the variables
to interpolate passed in via YAML file on the command line. This feature allows
the redaction of sensitive values (e.g. SSL keys) from the manifest. The format
is similar to Concourse&rsquo;s interpolation, except that interpolated values are
bracketed by double parentheses &ldquo;((key))&rdquo;, whereas Concourse uses double curly
braces &ldquo;{{key}}&rdquo;.</p><p>Similar to Concourse, the experimental BOSH CLI allows the YAML file containing
the secrets to be passed via the command line, e.g. <code>-l ~/secrets.yml</code> or
<code>-l &lt;(lpass show --note secrets)</code></p><p>The Golang CLI is in alpha and should not be used on production systems.</p><p><a name=google_cloud><sup>[Google Cloud]</sup></a>
We are deploying to <a href=https://cloud.google.com/>Google Cloud Platform</a>&rsquo;s <a href=https://cloud.google.com/compute/>Google
Compute Engine</a> (GCE), and thus the
<code>cloud_properties</code> sections of the BOSH Director&rsquo;s manifest may appear
unfamiliar to those who deploy on AWS or vSphere.</p><p><a name=privileged><sup>[privileged]</sup></a> Concourse will not bind to a
<a href=http://unix.stackexchange.com/questions/16564/why-are-the-first-1024-ports-restricted-to-the-root-user-only>privileged
port</a>.</p><p>You may attempt to force <code>atc</code> to bind to port 443 by setting its
<a href=https://github.com/concourse/concourse/blob/b0d0c99edb7a1f379c350426d0e71ab16b74da56/jobs/atc/spec#L42-L45>tls_bind_port</a>
job property, but it will not work, <code>atc</code> will not start, and you will see the
following message in <code>/var/vcap/sys/log/atc/atc.stderr.log</code>:</p><pre tabindex=0><code>web-tls  exited with error: listen tcp 0.0.0.0:443: bind: permission denied
</code></pre></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://blog.nono.io/post/concourse-badges/><span class=title>« Prev</span><br><span>Concourse has Badges</span>
</a><a class=next href=https://blog.nono.io/post/multi-homed-bosh-director/><span class=title>Next »</span><br><span>How to Deploy a Multi-homed BOSH Director to a vSphere Environment</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Concourse without a Load Balancer on x" href="https://x.com/intent/tweet/?text=Concourse%20without%20a%20Load%20Balancer&amp;url=https%3a%2f%2fblog.nono.io%2fpost%2fconcourse-no-elb%2f&amp;hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Concourse without a Load Balancer on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.nono.io%2fpost%2fconcourse-no-elb%2f&amp;title=Concourse%20without%20a%20Load%20Balancer&amp;summary=Concourse%20without%20a%20Load%20Balancer&amp;source=https%3a%2f%2fblog.nono.io%2fpost%2fconcourse-no-elb%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Concourse without a Load Balancer on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.nono.io%2fpost%2fconcourse-no-elb%2f&title=Concourse%20without%20a%20Load%20Balancer"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Concourse without a Load Balancer on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.nono.io%2fpost%2fconcourse-no-elb%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Concourse without a Load Balancer on whatsapp" href="https://api.whatsapp.com/send?text=Concourse%20without%20a%20Load%20Balancer%20-%20https%3a%2f%2fblog.nono.io%2fpost%2fconcourse-no-elb%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Concourse without a Load Balancer on telegram" href="https://telegram.me/share/url?text=Concourse%20without%20a%20Load%20Balancer&amp;url=https%3a%2f%2fblog.nono.io%2fpost%2fconcourse-no-elb%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Concourse without a Load Balancer on ycombinator" href="https://news.ycombinator.com/submitlink?t=Concourse%20without%20a%20Load%20Balancer&u=https%3a%2f%2fblog.nono.io%2fpost%2fconcourse-no-elb%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://blog.nono.io/>Brian Cunnie's Technical Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
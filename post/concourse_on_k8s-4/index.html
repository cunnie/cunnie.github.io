<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Concourse CI on Kubernetes (GKE), Part 4: Concourse | Brian Cunnie's Technical Blog</title><meta name=keywords content><meta name=description content="In our previous post, we configured our GKE (Google Kubernetes Engine) to use Let&rsquo;s Encrypt TLS certificates. In this post, the capstone of our series, we install Concourse CI.
Installation These instructions are a more-opinionated version of the canonical instructions for the Concourse CI Helm chart found here: https://github.com/concourse/concourse-chart.
First Install: with Helm We use helm to install Concourse. We first add the Helm repo, and then install it. We take the opportunity to bump the default login time from 24 hours to ten days (duration=240h) because we hate re-authenticating to our Concourse every morning."><meta name=author content="Brian Cunnie"><link rel=canonical href=https://blog.nono.io/post/concourse_on_k8s-4/><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.nono.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.nono.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.nono.io/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.nono.io/apple-touch-icon.png><link rel=mask-icon href=https://blog.nono.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-0NJ11E527T"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-0NJ11E527T",{anonymize_ip:!1})}</script><meta property="og:title" content="Concourse CI on Kubernetes (GKE), Part 4: Concourse"><meta property="og:description" content="In our previous post, we configured our GKE (Google Kubernetes Engine) to use Let&rsquo;s Encrypt TLS certificates. In this post, the capstone of our series, we install Concourse CI.
Installation These instructions are a more-opinionated version of the canonical instructions for the Concourse CI Helm chart found here: https://github.com/concourse/concourse-chart.
First Install: with Helm We use helm to install Concourse. We first add the Helm repo, and then install it. We take the opportunity to bump the default login time from 24 hours to ten days (duration=240h) because we hate re-authenticating to our Concourse every morning."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.nono.io/post/concourse_on_k8s-4/"><meta property="og:image" content="https://pbs.twimg.com/profile_images/971772210821070848/jnsjSQcw_400x400.jpg"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-09-01T18:39:26-07:00"><meta property="article:modified_time" content="2021-09-01T18:39:26-07:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://pbs.twimg.com/profile_images/971772210821070848/jnsjSQcw_400x400.jpg"><meta name=twitter:title content="Concourse CI on Kubernetes (GKE), Part 4: Concourse"><meta name=twitter:description content="In our previous post, we configured our GKE (Google Kubernetes Engine) to use Let&rsquo;s Encrypt TLS certificates. In this post, the capstone of our series, we install Concourse CI.
Installation These instructions are a more-opinionated version of the canonical instructions for the Concourse CI Helm chart found here: https://github.com/concourse/concourse-chart.
First Install: with Helm We use helm to install Concourse. We first add the Helm repo, and then install it. We take the opportunity to bump the default login time from 24 hours to ten days (duration=240h) because we hate re-authenticating to our Concourse every morning."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.nono.io/post/"},{"@type":"ListItem","position":2,"name":"Concourse CI on Kubernetes (GKE), Part 4: Concourse","item":"https://blog.nono.io/post/concourse_on_k8s-4/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Concourse CI on Kubernetes (GKE), Part 4: Concourse","name":"Concourse CI on Kubernetes (GKE), Part 4: Concourse","description":"In our previous post, we configured our GKE (Google Kubernetes Engine) to use Let\u0026rsquo;s Encrypt TLS certificates. In this post, the capstone of our series, we install Concourse CI.\nInstallation These instructions are a more-opinionated version of the canonical instructions for the Concourse CI Helm chart found here: https://github.com/concourse/concourse-chart.\nFirst Install: with Helm We use helm to install Concourse. We first add the Helm repo, and then install it. We take the opportunity to bump the default login time from 24 hours to ten days (duration=240h) because we hate re-authenticating to our Concourse every morning.","keywords":[],"articleBody":" In our previous post, we configured our GKE (Google Kubernetes Engine) to use Let’s Encrypt TLS certificates. In this post, the capstone of our series, we install Concourse CI.\nInstallation These instructions are a more-opinionated version of the canonical instructions for the Concourse CI Helm chart found here: https://github.com/concourse/concourse-chart.\nFirst Install: with Helm We use helm to install Concourse. We first add the Helm repo, and then install it. We take the opportunity to bump the default login time from 24 hours to ten days (duration=240h) because we hate re-authenticating to our Concourse every morning. Replace gke.nono.io with your DNS record:\nkubectl delete ingress kuard # to free up https://gke.nono.io helm repo add concourse https://concourse-charts.storage.googleapis.com/ helm install gke-nono-io concourse/concourse \\ --set concourse.web.externalUrl=https://gke.nono.io \\ --set concourse.web.auth.duration=240h \\ --set 'web.ingress.enabled=true' \\ --set 'web.ingress.annotations.cert-manager\\.io/issuer=letsencrypt-prod' \\ --set 'web.ingress.annotations.kubernetes\\.io/ingress.class=nginx' \\ --set 'web.ingress.hosts={gke.nono.io}' \\ --set 'web.ingress.tls[0].hosts[0]=gke.nono.io' \\ --set 'web.ingress.tls[0].secretName=gke.nono.io' \\ \\ --wait Browse to our site https://gke.nono.io. You’ll see a secure connection icon \u0026 the initial Concourse CI login page.\nFirst Upgrade: Locking Down Concourse Our Concourse is insecure: we haven’t changed the default private keys. Our Concourse is public-facing, and we must change the keys lest evildoers compromise us. The Concourse README warns:\nFor your convenience, this chart provides some default values for secrets, but it is recommended that you generate and manage these secrets outside the Helm chart.\nLet’s make our keys. The Concourse documentation provides two excellent ways to do it, and we’ve modified one of the ways to suit our setup. Replace gke.nono.io with your DNS record:\nmkdir -p secrets/ for KEY in session_signing_key tsa_host_key worker_key; do ssh-keygen -t rsa -b 4096 -m PEM -f secrets/$KEY -C $KEY \u003c /dev/null done rm secrets/session_signing_key.pub # \"You can remove the session_signing_key.pub file if you have one, it is not needed by any process in Concourse\" Let’s re-deploy our Concourse with our newly-generated secrets. Replace gke.nono.io with your DNS record:\nhelm upgrade gke-nono-io concourse/concourse \\ --set concourse.web.externalUrl=https://gke.nono.io \\ --set concourse.web.auth.duration=240h \\ --set 'web.ingress.enabled=true' \\ --set 'web.ingress.annotations.cert-manager\\.io/issuer=letsencrypt-prod' \\ --set 'web.ingress.annotations.kubernetes\\.io/ingress.class=nginx' \\ --set 'web.ingress.hosts={gke.nono.io}' \\ --set 'web.ingress.tls[0].hosts[0]=gke.nono.io' \\ --set 'web.ingress.tls[0].secretName=gke.nono.io' \\ \\ --set-file secrets.sessionSigningKey=secrets/session_signing_key \\ --set-file secrets.hostKey=secrets/tsa_host_key \\ --set-file secrets.hostKeyPub=secrets/tsa_host_key.pub \\ --set-file secrets.workerKey=secrets/worker_key \\ --set-file secrets.workerKeyPub=secrets/worker_key.pub \\ \\ --wait Third Upgrade: now with GitHub OAuth We have a Concourse CI server, and we’ve generated our own keys, but we’re still not secure: people can log in with the user “test” using the password “test”. Yes, really.\nWe don’t want to have any hard-coded users; we want to authenticate against our GitHub organization, “blabbertabber”, so we browse to our organization (https://github.com/blabbertabber) → Settings → Developer Settings → OAuth Apps → New OAuth App.\nNote: “Note that the client must be created under an organization if you want to authorize users based on organization/team membership.”\nHere’s how we filled out ours. Replace gke.nono.io with your URL. The authorization callback URL is particularly important; don’t mess it up:\nWe click “Register Application”, which brings us to the next screen, where we get the Client ID (5e4ffee9dfdced62ebe3) and then click “Generate a new client secret” to get the Client secret (549e10b1680ead9cafa30d4c9a715681cec9b074). Don’t forget to click “Update Application”!\nNow we can add the five GitHub OAuth-related lines to our helm upgrade command. Replace the GitHub org blabbertabber, the GitHub Client ID and Client Secret with the ones you’ve created, gke.nono.io with your DNS record:\nWhile we’re locking things down, we also remove the local user “test” (along with the easy-to-guess password, “test”). We do this by setting secrets.localUsers to “”. To be safe, we also disable local auth (we set concourse.web.localAuth.enabled to false).\nhelm upgrade gke-nono-io concourse/concourse \\ --set concourse.web.externalUrl=https://gke.nono.io \\ --set concourse.web.auth.duration=240h \\ --set 'web.ingress.enabled=true' \\ --set 'web.ingress.annotations.cert-manager\\.io/issuer=letsencrypt-prod' \\ --set 'web.ingress.annotations.kubernetes\\.io/ingress.class=nginx' \\ --set 'web.ingress.hosts={gke.nono.io}' \\ --set 'web.ingress.tls[0].hosts[0]=gke.nono.io' \\ --set 'web.ingress.tls[0].secretName=gke.nono.io' \\ \\ --set-file secrets.sessionSigningKey=secrets/session_signing_key \\ --set-file secrets.hostKey=secrets/tsa_host_key \\ --set-file secrets.hostKeyPub=secrets/tsa_host_key.pub \\ --set-file secrets.workerKey=secrets/worker_key \\ --set-file secrets.workerKeyPub=secrets/worker_key.pub \\ \\ --set secrets.localUsers=\"\" \\ --set concourse.web.localAuth.enabled=false \\ --set concourse.web.auth.mainTeam.github.org=blabbertabber \\ --set concourse.web.auth.github.enabled=true \\ --set secrets.githubClientId=5e4ffee9dfdced62ebe3 \\ --set secrets.githubClientSecret=549e10b1680ead9cafa30d4c9a715681cec9b074 \\ \\ --wait Browse to our URL: https://gke.nono.io. We log in with GitHub Auth. We authorize our app. We download \u0026 install our fly CLI. Then we log in. Replace gke.nono.io with your DNS record:\nfly -t gke login -c https://gke.nono.io # click the link # click \"Authorize blabbertabber\" # see \"login successful!\" We create the following simple pipeline file, simple.yml:\njobs: - name: simple plan: - task: simple config: platform: linux image_resource: type: docker-image source: repository: fedora run: path: \"true\" Let’s fly our new pipeline:\nfly -t gke set-pipeline -p simple -c simple.yml fly -t gke expose-pipeline -p simple fly -t gke unpause-pipeline -p simple We browse to our Concourse and see the sweet green of success (it’ll take a minute or two to run):\nYay! We’re done.\nPro-tip Rather than having an onerous number of --set arguments to our helm upgrade command, we find it easier to modify the corresponding settings in the values.yml file and pass it to our invocation of helm, i.e. helm upgrade -f values.yml .... Here’s our file of overrides.\nAddendum: Keeping Concourse Up-to-date Blindly upgrading Concourse without reading the release notes is a recipe for disaster; however, that’s what we’re going to show you. Let’s update the Helm repos first.\nhelm repo update Now let’s upgrade our install. Replace gke.nono.io with your DNS record:\nhelm upgrade gke-nono-io concourse/concourse \\ --set concourse.web.externalUrl=https://gke.nono.io \\ --set concourse.web.auth.duration=240h \\ --set 'web.ingress.enabled=true' \\ --set 'web.ingress.annotations.cert-manager\\.io/issuer=letsencrypt-prod' \\ --set 'web.ingress.annotations.kubernetes\\.io/ingress.class=nginx' \\ --set 'web.ingress.hosts={gke.nono.io}' \\ --set 'web.ingress.tls[0].hosts[0]=gke.nono.io' \\ --set 'web.ingress.tls[0].secretName=gke.nono.io' \\ \\ --set-file secrets.sessionSigningKey=secrets/session_signing_key \\ --set-file secrets.hostKey=secrets/tsa_host_key \\ --set-file secrets.hostKeyPub=secrets/tsa_host_key.pub \\ --set-file secrets.workerKey=secrets/worker_key \\ --set-file secrets.workerKeyPub=secrets/worker_key.pub \\ \\ --set secrets.localUsers=\"\" \\ --set concourse.web.localAuth.enabled=false \\ --set concourse.web.auth.mainTeam.github.org=blabbertabber \\ --set concourse.web.auth.github.enabled=true \\ --set secrets.githubClientId=5e4ffee9dfdced62ebe3 \\ --set secrets.githubClientSecret=549e10b1680ead9cafa30d4c9a715681cec9b074 \\ \\ --wait Browse to your Concourse server, and check that it has the updated version number.\nReferences Concourse CI Helm chart: https://github.com/concourse/concourse-chart Helm Chart Install: Advanced Usage of the “Set” Argument: https://itnext.io/helm-chart-install-advanced-usage-of-the-set-argument-3e214b69c87a Creating an OAuth App on GitHub: https://docs.github.com/en/developers/apps/building-oauth-apps/creating-an-oauth-app Updates/Errata 2021-11-13 Added section on keeping Concourse up-to-date.\n2021-11-14 Added section on locking down Concourse.\n","wordCount":"993","inLanguage":"en","datePublished":"2021-09-01T18:39:26-07:00","dateModified":"2021-09-01T18:39:26-07:00","author":{"@type":"Person","name":"Brian Cunnie"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.nono.io/post/concourse_on_k8s-4/"},"publisher":{"@type":"Organization","name":"Brian Cunnie's Technical Blog","logo":{"@type":"ImageObject","url":"https://blog.nono.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.nono.io/ accesskey=h title="Brian Cunnie's Technical Blog (Alt + H)">Brian Cunnie's Technical Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.nono.io/>Home</a>&nbsp;»&nbsp;<a href=https://blog.nono.io/post/>Posts</a></div><h1 class=post-title>Concourse CI on Kubernetes (GKE), Part 4: Concourse</h1><div class=post-meta><span title='2021-09-01 18:39:26 -0700 -0700'>September 1, 2021</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Brian Cunnie&nbsp;|&nbsp;<a href=https://github.com/cunnie/cunnie.github.io/tree/master/content/post/concourse_on_k8s-4.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><figure><img loading=lazy src=https://pbs.twimg.com/profile_images/971772210821070848/jnsjSQcw_400x400.jpg alt="Concourse logo"></figure><p>In our previous post, we configured our GKE (Google Kubernetes Engine) to
use Let&rsquo;s Encrypt TLS certificates. In this post, the capstone of our series, we
install Concourse CI.</p><h3 id=installation>Installation<a hidden class=anchor aria-hidden=true href=#installation>#</a></h3><p>These instructions are a more-opinionated version of the canonical instructions
for the Concourse CI Helm chart found here:
<a href=https://github.com/concourse/concourse-chart>https://github.com/concourse/concourse-chart</a>.</p><h4 id=first-install-with-helm>First Install: with Helm<a hidden class=anchor aria-hidden=true href=#first-install-with-helm>#</a></h4><p>We use <code>helm</code> to install Concourse. We first add the Helm repo, and then install
it. We take the opportunity to bump the default login time from 24 hours to ten
days (<code>duration=240h</code>) because we hate re-authenticating to our Concourse every
morning. <strong>Replace <code>gke.nono.io</code> with your DNS record</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl delete ingress kuard <span style=color:#75715e># to free up https://gke.nono.io</span>
</span></span><span style=display:flex><span>helm repo add concourse https://concourse-charts.storage.googleapis.com/
</span></span><span style=display:flex><span>helm install gke-nono-io concourse/concourse <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set concourse.web.externalUrl<span style=color:#f92672>=</span>https://gke.nono.io <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set concourse.web.auth.duration<span style=color:#f92672>=</span>240h <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.enabled=true&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.annotations.cert-manager\.io/issuer=letsencrypt-prod&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.annotations.kubernetes\.io/ingress.class=nginx&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.hosts={gke.nono.io}&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.tls[0].hosts[0]=gke.nono.io&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.tls[0].secretName=gke.nono.io&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --wait
</span></span></code></pre></div><p>Browse to our site <a href=https://gke.nono.io>https://gke.nono.io</a>. You&rsquo;ll see a secure connection icon &
the initial Concourse CI login page.</p><h4 id=first-upgrade-locking-down-concourse>First Upgrade: Locking Down Concourse<a hidden class=anchor aria-hidden=true href=#first-upgrade-locking-down-concourse>#</a></h4><p>Our Concourse is insecure: we haven&rsquo;t changed the default private keys. Our
Concourse is public-facing, and we must change the keys lest evildoers
compromise us. The <a href=https://github.com/concourse/concourse-chart/tree/4cab2d0d2023a80e870a98500fa834f5fa7990d7#secrets>Concourse
README</a>
warns:</p><blockquote><p>For your convenience, this chart provides some default values for secrets,
but it is recommended that you <strong>generate and manage these secrets outside the
Helm chart</strong>.</p></blockquote><p>Let&rsquo;s make our keys. The <a href=https://concourse-ci.org/concourse-generate-key.html>Concourse
documentation</a> provides
two excellent ways to do it, and we&rsquo;ve modified one of the ways to suit our
setup. <strong>Replace <code>gke.nono.io</code> with your DNS record</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir -p secrets/
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> KEY in session_signing_key tsa_host_key worker_key; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>  ssh-keygen -t rsa -b <span style=color:#ae81ff>4096</span> -m PEM -f secrets/$KEY -C $KEY &lt; /dev/null
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>rm secrets/session_signing_key.pub <span style=color:#75715e># &#34;You can remove the session_signing_key.pub file if you have one, it is not needed by any process in Concourse&#34;</span>
</span></span></code></pre></div><p>Let&rsquo;s re-deploy our Concourse with our newly-generated secrets. <strong>Replace
<code>gke.nono.io</code> with your DNS record</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>helm upgrade gke-nono-io concourse/concourse <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set concourse.web.externalUrl<span style=color:#f92672>=</span>https://gke.nono.io <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set concourse.web.auth.duration<span style=color:#f92672>=</span>240h <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.enabled=true&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.annotations.cert-manager\.io/issuer=letsencrypt-prod&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.annotations.kubernetes\.io/ingress.class=nginx&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.hosts={gke.nono.io}&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.tls[0].hosts[0]=gke.nono.io&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.tls[0].secretName=gke.nono.io&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set-file secrets.sessionSigningKey<span style=color:#f92672>=</span>secrets/session_signing_key <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set-file secrets.hostKey<span style=color:#f92672>=</span>secrets/tsa_host_key <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set-file secrets.hostKeyPub<span style=color:#f92672>=</span>secrets/tsa_host_key.pub <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set-file secrets.workerKey<span style=color:#f92672>=</span>secrets/worker_key <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set-file secrets.workerKeyPub<span style=color:#f92672>=</span>secrets/worker_key.pub <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --wait
</span></span></code></pre></div><h4 id=third-upgrade-now-with-github-oauth>Third Upgrade: now with GitHub OAuth<a hidden class=anchor aria-hidden=true href=#third-upgrade-now-with-github-oauth>#</a></h4><p>We have a Concourse CI server, and we&rsquo;ve generated our own keys, but we&rsquo;re
still not secure: people can log in with the user &ldquo;test&rdquo; using the password
&ldquo;test&rdquo;. Yes, really.</p><p>We don&rsquo;t want to have any hard-coded users; we want to authenticate against our
GitHub organization, &ldquo;blabbertabber&rdquo;, so we browse to our organization
(<a href=https://github.com/blabbertabber>https://github.com/blabbertabber</a>) → Settings → Developer Settings → OAuth
Apps → New OAuth App.</p><p><em>Note: &ldquo;<a href=https://concourse-ci.org/github-auth.html>Note that the client must be created under an organization if you want
to authorize users based on organization/team
membership</a>.&rdquo;</em></p><p>Here&rsquo;s how we filled out ours. <strong>Replace <code>gke.nono.io</code> with your URL</strong>. The
authorization callback URL is particularly important; don&rsquo;t mess it up:</p><figure><img loading=lazy src=https://user-images.githubusercontent.com/1020675/132111425-a20812dc-78c6-41bb-ae9f-5e6fde7c1d6f.png alt="GitHub OAuth Application #1"></figure><p>We click &ldquo;Register Application&rdquo;, which brings us to the next screen, where we
get the Client ID (<code>5e4ffee9dfdced62ebe3</code>) and then click &ldquo;Generate a new client
secret&rdquo; to get the Client secret (<code>549e10b1680ead9cafa30d4c9a715681cec9b074</code>).
Don&rsquo;t forget to click &ldquo;Update Application&rdquo;!</p><figure><img loading=lazy src=https://user-images.githubusercontent.com/1020675/132131649-678f961b-978a-4055-8388-0b67debbc62e.png alt="GitHub OAuth Application #2"></figure><p>Now we can add the five GitHub OAuth-related lines to our <code>helm upgrade</code>
command. <strong>Replace the GitHub org <code>blabbertabber</code>, the GitHub Client ID and
Client Secret with the ones you&rsquo;ve created, <code>gke.nono.io</code> with your DNS
record</strong>:</p><p>While we&rsquo;re locking things down, we also remove the local user &ldquo;test&rdquo; (along
with the easy-to-guess password, &ldquo;test&rdquo;). We do this by setting
<code>secrets.localUsers</code> to &ldquo;&rdquo;. To be safe, we also disable local auth (we set
<code>concourse.web.localAuth.enabled</code> to false).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>helm upgrade gke-nono-io concourse/concourse <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set concourse.web.externalUrl<span style=color:#f92672>=</span>https://gke.nono.io <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set concourse.web.auth.duration<span style=color:#f92672>=</span>240h <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.enabled=true&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.annotations.cert-manager\.io/issuer=letsencrypt-prod&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.annotations.kubernetes\.io/ingress.class=nginx&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.hosts={gke.nono.io}&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.tls[0].hosts[0]=gke.nono.io&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.tls[0].secretName=gke.nono.io&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set-file secrets.sessionSigningKey<span style=color:#f92672>=</span>secrets/session_signing_key <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set-file secrets.hostKey<span style=color:#f92672>=</span>secrets/tsa_host_key <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set-file secrets.hostKeyPub<span style=color:#f92672>=</span>secrets/tsa_host_key.pub <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set-file secrets.workerKey<span style=color:#f92672>=</span>secrets/worker_key <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set-file secrets.workerKeyPub<span style=color:#f92672>=</span>secrets/worker_key.pub <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set secrets.localUsers<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set concourse.web.localAuth.enabled<span style=color:#f92672>=</span>false <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set concourse.web.auth.mainTeam.github.org<span style=color:#f92672>=</span>blabbertabber <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set concourse.web.auth.github.enabled<span style=color:#f92672>=</span>true <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set secrets.githubClientId<span style=color:#f92672>=</span>5e4ffee9dfdced62ebe3 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set secrets.githubClientSecret<span style=color:#f92672>=</span>549e10b1680ead9cafa30d4c9a715681cec9b074 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --wait
</span></span></code></pre></div><p>Browse to our URL: <a href=https://gke.nono.io>https://gke.nono.io</a>. We log in with GitHub Auth. We
authorize our app. We download & install our <code>fly</code> CLI. Then we log in.
<strong>Replace <code>gke.nono.io</code> with your DNS record</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>fly -t gke login -c https://gke.nono.io
</span></span><span style=display:flex><span> <span style=color:#75715e># click the link</span>
</span></span><span style=display:flex><span> <span style=color:#75715e># click &#34;Authorize blabbertabber&#34;</span>
</span></span><span style=display:flex><span> <span style=color:#75715e># see &#34;login successful!&#34;</span>
</span></span></code></pre></div><p>We create the following simple pipeline file, <code>simple.yml</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>simple</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>plan</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>task</span>: <span style=color:#ae81ff>simple</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>config</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>linux</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>image_resource</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>type</span>: <span style=color:#ae81ff>docker-image</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>source</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>repository</span>: <span style=color:#ae81ff>fedora</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>run</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>path</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span></code></pre></div><p>Let&rsquo;s <code>fly</code> our new pipeline:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>fly -t gke set-pipeline -p simple -c simple.yml
</span></span><span style=display:flex><span>fly -t gke expose-pipeline -p simple
</span></span><span style=display:flex><span>fly -t gke unpause-pipeline -p simple
</span></span></code></pre></div><p>We browse to our Concourse and see the sweet green of success (it&rsquo;ll take a
minute or two to run):</p><figure><img loading=lazy src=https://user-images.githubusercontent.com/1020675/132144890-29253cd7-18bb-4c99-8466-10f4013000ec.png alt="A successful green build!"></figure><p>Yay! We&rsquo;re done.</p><h4 id=pro-tip>Pro-tip<a hidden class=anchor aria-hidden=true href=#pro-tip>#</a></h4><p>Rather than having an onerous number of <code>--set</code> arguments to our <code>helm upgrade</code>
command, we find it easier to modify the corresponding settings in the
<a href=https://github.com/concourse/concourse-chart/blob/master/values.yaml><code>values.yml</code></a>
file and pass it to our invocation of <code>helm</code>, i.e. <code>helm upgrade -f values.yml ...</code>. Here&rsquo;s our <a href=https://github.com/cunnie/deployments/blob/5111c782e8f1670616be354781958f1f0955cdae/terraform/gcp/gke/concourse-values.yml>file of
overrides</a>.</p><h3 id=addendum-keeping-concourse-up-to-date>Addendum: Keeping Concourse Up-to-date<a hidden class=anchor aria-hidden=true href=#addendum-keeping-concourse-up-to-date>#</a></h3><p>Blindly upgrading Concourse without reading the release notes is a recipe for
disaster; however, that&rsquo;s what we&rsquo;re going to show you. Let&rsquo;s update the Helm
repos first.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>helm repo update
</span></span></code></pre></div><p>Now let&rsquo;s upgrade our install. <strong>Replace <code>gke.nono.io</code> with your DNS record</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>helm upgrade gke-nono-io concourse/concourse <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set concourse.web.externalUrl<span style=color:#f92672>=</span>https://gke.nono.io <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set concourse.web.auth.duration<span style=color:#f92672>=</span>240h <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.enabled=true&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.annotations.cert-manager\.io/issuer=letsencrypt-prod&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.annotations.kubernetes\.io/ingress.class=nginx&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.hosts={gke.nono.io}&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.tls[0].hosts[0]=gke.nono.io&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set <span style=color:#e6db74>&#39;web.ingress.tls[0].secretName=gke.nono.io&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set-file secrets.sessionSigningKey<span style=color:#f92672>=</span>secrets/session_signing_key <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set-file secrets.hostKey<span style=color:#f92672>=</span>secrets/tsa_host_key <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set-file secrets.hostKeyPub<span style=color:#f92672>=</span>secrets/tsa_host_key.pub <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set-file secrets.workerKey<span style=color:#f92672>=</span>secrets/worker_key <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set-file secrets.workerKeyPub<span style=color:#f92672>=</span>secrets/worker_key.pub <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set secrets.localUsers<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set concourse.web.localAuth.enabled<span style=color:#f92672>=</span>false <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set concourse.web.auth.mainTeam.github.org<span style=color:#f92672>=</span>blabbertabber <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set concourse.web.auth.github.enabled<span style=color:#f92672>=</span>true <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set secrets.githubClientId<span style=color:#f92672>=</span>5e4ffee9dfdced62ebe3 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set secrets.githubClientSecret<span style=color:#f92672>=</span>549e10b1680ead9cafa30d4c9a715681cec9b074 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --wait
</span></span></code></pre></div><p>Browse to your Concourse server, and check that it has the updated version
number.</p><hr><h3 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h3><ul><li>Concourse CI Helm chart: <a href=https://github.com/concourse/concourse-chart>https://github.com/concourse/concourse-chart</a></li><li>Helm Chart Install: Advanced Usage of the “Set” Argument: <a href=https://itnext.io/helm-chart-install-advanced-usage-of-the-set-argument-3e214b69c87a>https://itnext.io/helm-chart-install-advanced-usage-of-the-set-argument-3e214b69c87a</a></li><li>Creating an OAuth App on GitHub:
<a href=https://docs.github.com/en/developers/apps/building-oauth-apps/creating-an-oauth-app>https://docs.github.com/en/developers/apps/building-oauth-apps/creating-an-oauth-app</a></li></ul><h3 id=updateserrata>Updates/Errata<a hidden class=anchor aria-hidden=true href=#updateserrata>#</a></h3><p><strong>2021-11-13</strong> Added section on keeping Concourse up-to-date.</p><p><strong>2021-11-14</strong> Added section on locking down Concourse.</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://blog.nono.io/post/concourse_on_k8s-5/><span class=title>« Prev</span><br><span>Concourse CI on Kubernetes (GKE), Part 5: Vault</span></a>
<a class=next href=https://blog.nono.io/post/concourse_on_k8s-3/><span class=title>Next »</span><br><span>Concourse CI on Kubernetes (GKE), Part 3: TLS</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Concourse CI on Kubernetes (GKE), Part 4: Concourse on twitter" href="https://twitter.com/intent/tweet/?text=Concourse%20CI%20on%20Kubernetes%20%28GKE%29%2c%20Part%204%3a%20Concourse&url=https%3a%2f%2fblog.nono.io%2fpost%2fconcourse_on_k8s-4%2f&hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Concourse CI on Kubernetes (GKE), Part 4: Concourse on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.nono.io%2fpost%2fconcourse_on_k8s-4%2f&title=Concourse%20CI%20on%20Kubernetes%20%28GKE%29%2c%20Part%204%3a%20Concourse&summary=Concourse%20CI%20on%20Kubernetes%20%28GKE%29%2c%20Part%204%3a%20Concourse&source=https%3a%2f%2fblog.nono.io%2fpost%2fconcourse_on_k8s-4%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Concourse CI on Kubernetes (GKE), Part 4: Concourse on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.nono.io%2fpost%2fconcourse_on_k8s-4%2f&title=Concourse%20CI%20on%20Kubernetes%20%28GKE%29%2c%20Part%204%3a%20Concourse"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Concourse CI on Kubernetes (GKE), Part 4: Concourse on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.nono.io%2fpost%2fconcourse_on_k8s-4%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Concourse CI on Kubernetes (GKE), Part 4: Concourse on whatsapp" href="https://api.whatsapp.com/send?text=Concourse%20CI%20on%20Kubernetes%20%28GKE%29%2c%20Part%204%3a%20Concourse%20-%20https%3a%2f%2fblog.nono.io%2fpost%2fconcourse_on_k8s-4%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Concourse CI on Kubernetes (GKE), Part 4: Concourse on telegram" href="https://telegram.me/share/url?text=Concourse%20CI%20on%20Kubernetes%20%28GKE%29%2c%20Part%204%3a%20Concourse&url=https%3a%2f%2fblog.nono.io%2fpost%2fconcourse_on_k8s-4%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://blog.nono.io/>Brian Cunnie's Technical Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>